function preload(){game.load.crossOrigin="anonymous",game.load.image("bg","https://dl.dropbox.com/s/6g7eq144u63sofr/pozadina.jpg?dl=0"),game.load.image("ship","https://dl.dropbox.com/s/ev85mgwop6iz2w7/ship_invaders.png?dl=0"),game.load.image("bullet","https://dl.dropbox.com/s/cuwp7fwoid3o2wz/ship_bullet.png?dl=0"),game.load.image("bullet2","https://dl.dropbox.com/s/jb3q3l4iul5wjfs/ship_bullet_2.png?dl=0"),game.load.image("invader-a","https://dl.dropbox.com/s/ofs2up142o9ignf/a.png?dl=0"),game.load.image("invader-b","https://dl.dropbox.com/s/q9kv2k6my3pmxnm/b.png?dl=0"),game.load.image("invader-c","https://dl.dropbox.com/s/dj79k5ou8fjl69j/c.png?dl=0"),game.load.image("invader-d","https://dl.dropbox.com/s/r5ozvu5vvt28q5w/d.png?dl=0"),game.load.image("invader-e","https://dl.dropbox.com/s/z0f0se2sv3jjm89/e.png?dl=0"),game.load.image("invader-f","https://dl.dropbox.com/s/b7pgqsgk10hzh1b/f.png?dl=0"),game.load.image("invader-g","https://dl.dropbox.com/s/ts7d5id10vbdb6u/g.png?dl=0"),game.load.image("invader-h","https://dl.dropbox.com/s/08lobltjwxhhiic/h.png?dl=0"),game.load.image("invader-i","https://dl.dropbox.com/s/9xdckut741w2aec/i.png?dl=0"),game.load.image("invader-j (đ)","https://dl.dropbox.com/s/lgidbqcufbh5tfh/j.png?dl=0"),game.load.image("invader-k","https://dl.dropbox.com/s/b6gj5jqrbfzpyof/k.png?dl=0"),game.load.image("invader-l","https://dl.dropbox.com/s/dot5eehm1mi6juu/l.png?dl=0"),game.load.image("invader-m","https://dl.dropbox.com/s/gktyi5926je6owt/m.png?dl=0"),game.load.image("invader-ć, šć","https://dl.dropbox.com/s/6h0j6jw4qhetefq/meko-c.png?dl=0"),game.load.image("invader-n","https://dl.dropbox.com/s/7jifk4j8dunmag0/n.png?dl=0"),game.load.image("invader-o","https://dl.dropbox.com/s/73ield8mkwb3e6d/o.png?dl=0"),game.load.image("invader-p","https://dl.dropbox.com/s/8ya5iyvsul9k5jo/p.png?dl=0"),game.load.image("invader-r","https://dl.dropbox.com/s/uajun33ys9hlov0/r.png?dl=0"),game.load.image("invader-s","https://dl.dropbox.com/s/q57o37rwvc6wtaw/s.png?dl=0"),game.load.image("invader-š","https://dl.dropbox.com/s/fgb3dnx73ozmn8e/slovo-s.png?dl=0"),game.load.image("invader-ž","https://dl.dropbox.com/s/r5whthcxnajolvt/slovo-z.png?dl=0"),game.load.image("invader-t","https://dl.dropbox.com/s/ojyo21zo1m33yud/t.png?dl=0"),game.load.image("invader-č","https://dl.dropbox.com/s/kwanvgkfg6jexq2/tvrdo-c.png?dl=0"),game.load.image("invader-u","https://dl.dropbox.com/s/5lanercj92jcno1/u.png?dl=0"),game.load.image("invader-v","https://dl.dropbox.com/s/rtibe2xgtxbhuv4/v.png?dl=0"),game.load.image("invader-z","https://dl.dropbox.com/s/mt80spoayvt74cu/z.png?dl=0")}function create(){pozadina.play(),cursors=game.input.keyboard.createCursorKeys(),game.input.keyboard.addKeyCapture(Phaser.Keyboard.SPACEBAR);game.add.image(0,0,"bg").alpha=.5,(ship=game.add.sprite(game.world.centerX,game.height-SHIP_YOFS,"ship")).anchor.setTo(.5,1),(enemyBullets=game.add.group()).enableBody=!0,enemyBullets.physicsBodyType=Phaser.Physics.ARCADE,enemyBullets.createMultiple(5,"bullet2",0,!1),enemyBullets.setAll("anchor.x",.5),enemyBullets.setAll("anchor.y",.5),enemyBullets.setAll("outOfBoundsKill",!0),enemyBullets.setAll("checkWorldBounds",!0),enemies=game.add.group(),_initEnemies();var e={font:"20px monospace",fill:"yellow"};game.add.text(game.world.width-10,10,"REZULTAT",e).anchor.setTo(1,0),(scoreText=game.add.text(game.world.width-10,30,"0",e)).anchor.setTo(1,0);var o=game.add.image(10,game.height-10,"ship");o.anchor.setTo(0,1),o.scale.setTo(.5,.5),(livesText=game.add.text(40,game.world.height,lives,{font:"15px monospace",fill:"yellow"})).anchor.setTo(0,1),game.physics.startSystem(Phaser.Physics.ARCADE),game.physics.enable([ship,enemies],Phaser.Physics.ARCADE),ship.body.immovable=!0,ship.body.collideWorldBounds=!0,KEYS.SHIP_LEFT=game.input.keyboard.addKey(Phaser.Keyboard.A),KEYS.SHIP_RIGHT=game.input.keyboard.addKey(Phaser.Keyboard.D),KEYS.FIRE=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),lastFireTime=game.time.now,moveTimerLoop=game.time.events.loop(MOVE_TIME,_moveEnemies)}function create2(){0!=smrt&&(enemies.removeAll(),SPACING_Y=40,(ship=game.add.sprite(game.world.centerX,game.height-SHIP_YOFS,"ship")).anchor.setTo(.5,1),(enemyBullets=game.add.group()).enableBody=!0,enemyBullets.physicsBodyType=Phaser.Physics.ARCADE,enemyBullets.createMultiple(5,"bullet2",0,!1),enemyBullets.setAll("anchor.x",.5),enemyBullets.setAll("anchor.y",.5),enemyBullets.setAll("outOfBoundsKill",!0),enemyBullets.setAll("checkWorldBounds",!0),enemies=game.add.group(),_initEnemies(),lives=2,livesText.setText(lives),score=0,scoreText.setText(score),game.physics.startSystem(Phaser.Physics.ARCADE),game.physics.enable([ship,enemies],Phaser.Physics.ARCADE),ship.body.immovable=!0,ship.body.collideWorldBounds=!0,KEYS.SHIP_LEFT=game.input.keyboard.addKey(Phaser.Keyboard.A),KEYS.SHIP_RIGHT=game.input.keyboard.addKey(Phaser.Keyboard.D),KEYS.FIRE=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),lastFireTime=game.time.now,moveTimerLoop=game.time.events.loop(MOVE_TIME,_moveEnemies),smrt=0)}function _initEnemies(){enemies.removeAll(),enemies.position.set(START_X,START_Y),rand=["a","b","c","č","ć, šć","d","e","f","g","h","i","j (đ)","k","l","m","n","o","p","r","s","š","u","v","t","z","ž"];for(var e=0;e<ROWS;e++){0==e?(1,30):e<ROWS-2?(2,20):(3,10);for(var o=0;o<COLS;o++){var a=SPACING_X*o,l=SPACING_Y*e;br=rand[Math.floor(Math.random()*rand.length)];var s=game.add.sprite(a,l,"invader-"+br);s.anchor.setTo(.5,.5),s.score=br,enemies.add(s)}}game.physics.enable(enemies,Phaser.Physics.ARCADE),moveTimerLoop&&(moveTimerLoop.delay=MOVE_TIME)}function _moveEnemies(){var e=enemies.position.x,o=enemies.position.x+(COLS-1)*SPACING_X;!justDescended&&(o+MOVE_STEP>game.width-SIDE_GUTTER||e+MOVE_STEP<SIDE_GUTTER)?(MOVE_STEP=-MOVE_STEP,enemies.position.y+=DESCENT_STEP,justDescended=!0):(enemies.position.x+=MOVE_STEP,justDescended=!1)}function _bulletHitEnemy(e,o){score+=10,scoreText.setText(score),o.kill(),e.kill();var a=game.add.text(o.world.x,o.world.y,o.score,{font:"20px monospace",fill:"#ffff00"});a.anchor.setTo(.5,.5),game.time.events.add(200,function(){a.destroy()}),0===enemies.countLiving()&&(score+=WAVE_CLEAR_BONUS,START_Y+=SPACING_Y,_initEnemies());var l=.05+enemies.countLiving()/(ROWS*COLS)*.95;moveTimerLoop.delay=MOVE_TIME*l}function update(){if(playerBullet&&playerBullet.alive&&game.physics.arcade.collide(playerBullet,enemies,_bulletHitEnemy),ship.alive){if(game.physics.arcade.collide(enemies,ship,function(){console.log("Ship-to-enemy collision")}),game.physics.arcade.collide(ship,enemyBullets,function(e,o){if(e.kill(),o.kill(),--lives>=0)livesText.setText(lives),game.time.events.add(2e3,function(){ship.reset(game.world.centerX,game.height-SHIP_YOFS),ship.revive()});else{smrt=1,vrisak.play();var a=game.add.text(game.world.centerX,game.world.centerY,"KRAJ IGRE",{font:"40px monospace",fill:"yellow"}),l=game.add.text(game.world.centerX,game.world.centerY+50,"PRITISNITE SPACE ZA NOVU IGRU",{font:"30px monospace",fill:"yellow"});playerBullet&&playerBullet.destroy(),a.anchor.setTo(.5,.5),l.anchor.setTo(.5,.5),game.time.events.remove(moveTimerLoop),0==!smrt&&$(document).on("keyup",function(e){32==e.keyCode&&(a.setText(""),l.setText(""),create2())})}}),KEYS.SHIP_LEFT.isDown||cursors.left.isDown?ship.body.velocity.x=-SHIP_SPEED:KEYS.SHIP_RIGHT.isDown||cursors.right.isDown?ship.body.velocity.x=SHIP_SPEED:ship.body.velocity.x=0,KEYS.FIRE.isDown){if(playerBullet&&playerBullet.alive)return!1;(playerBullet=game.add.sprite(ship.x,ship.y-ship.height,"bullet")).anchor.setTo(.5,.5),strela.play(),game.physics.arcade.enable(playerBullet,Phaser.Physics.ARCADE),playerBullet.checkWorldBounds=!0,playerBullet.outOfBoundsKill=!0,playerBullet.body.velocity.y=-BULLET_SPEED_P}if(game.time.now>lastFireTime){var e=enemyBullets.getFirstExists(!1);if(e){var o=[];enemies.forEachAlive(function(e){o.push(e)}),strela2.play();var a=Phaser.ArrayUtils.getRandomItem(o);e.reset(a.world.x,a.world.y),e.body.velocity.y=BULLET_SPEED_E}lastFireTime=game.time.now+FIRE_DELAY}}}console.clear(),window.PhaserGlobal=window.PhaserGlobal||{},window.PhaserGlobal.stopFocus=!0;var ship,enemies,enemyBullets,scoreText,livesText,moveTimerLoop,cursors,lastFireTime,game=new Phaser.Game(800,600,Phaser.AUTO,"game-wrap",{preload:preload,create:create,update:update}),playerBullet=null,score=0,lives=2,pritisnuto=0,smrt=0;justDescended=!1;var strela=document.getElementById("strela"),vrisak=document.getElementById("vrisak"),strela2=document.getElementById("strela2"),pozadina=document.getElementById("pozadina"),SHIP_SPEED=200,SHIP_YOFS=30,BULLET_SPEED_P=600,WAVE_CLEAR_BONUS=1e3,KEYS={},ROWS=5,COLS=11,SPACING_X=50,SPACING_Y=40,START_X=100,START_Y=100,MOVE_TIME=600,MOVE_STEP=10,DESCENT_STEP=10,SIDE_GUTTER=20,BULLET_SPEED_E=400,FIRE_DELAY=1e3;$(document).on("keyup",function(e){80==e.keyCode?0==game.paused?(game.paused=!0,$("#pauza").show()):(game.paused=!1,$("#pauza").hide(),$("#pozadina").play()):81==e.keyCode&&(jQuery("audio").prop("muted")?jQuery("audio").prop("muted",!1):jQuery("audio").prop("muted",!0))});